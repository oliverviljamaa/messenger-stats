(this["webpackJsonpmessenger-stats"]=this["webpackJsonpmessenger-stats"]||[]).push([[0],{338:function(e,t,n){e.exports=n(562)},343:function(e,t,n){},562:function(e,t,n){"use strict";n.r(t);var r,a=n(1),c=n.n(a),u=n(13),i=n.n(u),o=(n(343),n(25)),s=(n(563),n(303)),l=n(44),f=n.n(l),m=n(136),d=n(192),p=n(89),b=n(193),E=n(92),v=n(580),O=n(581),g=n(582),y=n(583),h=n(592);!function(e){e.DAY="DAY",e.WEEK="WEEK",e.MONTH="MONTH",e.YEAR="YEAR"}(r||(r={}));var j=r.DAY,w=r.WEEK,M=r.MONTH,k=r.YEAR;function A(e){return T.apply(this,arguments)}function T(){return(T=Object(p.a)(f.a.mark((function e(t){var n,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Array.from(t).map(x),e.next=3,Promise.all(n);case 3:return r=e.sent.flat(),e.abrupt("return",R(r));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Y={DAY:[],WEEK:[],MONTH:[],YEAR:[]};function R(e){return{DAY:B(e,j),WEEK:B(e,w),MONTH:B(e,M),YEAR:B(e,k)}}function x(e){return N.apply(this,arguments)}function N(){return(N=Object(p.a)(f.a.mark((function e(t){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,W(t);case 2:return n=e.sent,e.abrupt("return",n?S(n):[]);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function W(e){return D.apply(this,arguments)}function D(){return(D=Object(p.a)(f.a.mark((function e(t){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,H(t);case 2:return n=e.sent,e.abrupt("return",n?JSON.parse(n):null);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function H(e){return new Promise((function(t){var n=new FileReader;n.onload=function(e){var n,r=null===(n=e.target)||void 0===n?void 0:n.result;t(r?r.toString():null)},n.readAsText(e)}))}function S(e){return e.messages.map((function(e){var t=e.sender_name,n=e.content,r=e.timestamp_ms;return{sender:Object(b.decode)(t),content:n?Object(b.decode)(n):null,time:r}}))}function B(e,t){var n=Object(E.sortBy)(e,"time"),r=function(e,t){var n={DAY:function(e){return Object(v.a)(e).getTime()},WEEK:function(e){return Object(O.a)(e,{weekStartsOn:1}).getTime()},MONTH:function(e){return Object(g.a)(e).getTime()},YEAR:function(e){return Object(y.a)(e).getTime()}};return Object(E.groupBy)(e,(function(e){var r=e.time;return n[t](r)}))}(n,t),a=function(e){return Object(E.orderBy)(Object.entries(K(e)).map((function(e){var t=Object(o.a)(e,2);return{sender:t[0],numberOfMessages:t[1]}})),"numberOfMessages","desc").map((function(e){return e.sender}))}(n);return Object.entries(r).map((function(e){var n=Object(o.a)(e,2),r=n[0],c=K(n[1]);return Object(d.a)({id:P(Number(r),t)},a.reduce((function(e,t){return Object(d.a)({},e,Object(m.a)({},t,c[t]||0))}),{}))}))}function K(e){return Object(E.mapValues)(function(e){return Object(E.groupBy)(e,(function(e){return e.sender}))}(e),(function(e){return e.length}))}function P(e,t){return"".concat(Object(h.a)(new Date(e),{DAY:"dd/MM/yyyy",WEEK:"dd/MM/yyyy",MONTH:"MMM yyyy",YEAR:"yyyy"}[t])).concat({DAY:"",WEEK:" week",MONTH:"",YEAR:""}[t])}n(564);var U=n(302),_=(n(209),n(304)),C=n(594);function I(){}var J=function(e){var t=e.onComplete,n=e.style;return c.a.createElement(U.a,{beforeUpload:function(){var e=Object(p.a)(f.a.mark((function e(n,r){var a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=r,n.uid!==c[c.length-1].uid){e.next=5;break}return e.next=3,A(r);case 3:a=e.sent,t(a);case 5:return e.abrupt("return",Promise.resolve());case 6:case"end":return e.stop()}var c}),e)})));return function(t,n){return e.apply(this,arguments)}}(),customRequest:I,accept:"application/json",multiple:!0,showUploadList:!1},c.a.createElement(_.a,{style:n},c.a.createElement(C.a,null)," Upload messages"))},L=(n(420),n(204)),F=function(e){var t=e.selected,n=e.onSelect,a=e.disabled,u=e.disabledUnits;return c.a.createElement(L.a.Group,{disabled:a},Object.values(r).map((function(e){return c.a.createElement(L.a.Button,{value:e,checked:e===t,onChange:function(e){var t=e.target.value;return n(t)},disabled:u.includes(e),key:e},e)})))},G=(n(422),n(54)),V=function(){return c.a.createElement(G.a,{image:G.a.PRESENTED_IMAGE_SIMPLE,style:{marginTop:128}})},q=n(288);function X(e){return e.length>20?e.filter((function(t,n){return n%Math.floor(e.length/20)===0})).map((function(e){return e.id})):void 0}var $=function(e){var t=e.data;return c.a.createElement("div",{style:{height:640}},c.a.createElement(q.a,{data:t,keys:t.length>0?Object.keys(t[0]).filter((function(e){return"id"!==e})):[],margin:{top:48,right:256,bottom:96,left:48},enableLabel:!1,axisBottom:{tickPadding:8,tickRotation:-45,tickValues:X(t)},legends:[{dataFrom:"keys",anchor:"bottom-right",direction:"column",translateX:128,itemWidth:128,itemHeight:20}],animate:!1}))},z=s.a.Title;function Q(e){return Object.values(r).filter((function(t){return e[t].length>500}))}var Z=function(){var e=Object(a.useState)(Y),t=Object(o.a)(e,2),n=t[0],u=t[1],i=Object(a.useState)(r.MONTH),s=Object(o.a)(i,2),l=s[0],f=s[1],m=n[l];return c.a.createElement("main",{style:{padding:32}},c.a.createElement(z,null,"Messenger stats"),c.a.createElement(J,{onComplete:u,style:{marginRight:16}}),c.a.createElement(F,{selected:l,onSelect:f,disabled:n===Y,disabledUnits:Q(n)}),n===Y?c.a.createElement(V,null):c.a.createElement($,{data:m}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(c.a.createElement(Z,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[338,1,2]]]);
//# sourceMappingURL=main.24c4db1c.chunk.js.map
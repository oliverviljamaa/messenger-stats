(this["webpackJsonpmessenger-stats"]=this["webpackJsonpmessenger-stats"]||[]).push([[0],{339:function(e,t,n){e.exports=n(563)},344:function(e,t,n){},563:function(e,t,n){"use strict";n.r(t);var r,a=n(1),u=n.n(a),c=n(13),i=n.n(c),o=(n(344),n(27)),s=(n(564),n(304)),l=n(44),f=n.n(l),m=n(136),d=n(192),p=n(89),b=n(193),E=n(92),O=n(581),g=n(194),v=n(582),h=n(583),y=n(584),j=n(599),w=n(585),M=n(586),A=n(595);!function(e){e.DAY="DAY",e.WEEK="WEEK",e.MONTH="MONTH",e.YEAR="YEAR"}(r||(r={}));var k=r.DAY,T=r.WEEK,Y=r.MONTH,R=r.YEAR;function N(e){return x.apply(this,arguments)}function x(){return(x=Object(p.a)(f.a.mark((function e(t){var n,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Array.from(t).map(H),e.next=3,Promise.all(n);case 3:return r=e.sent.flat(),e.abrupt("return",D(r));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var W={DAY:[],WEEK:[],MONTH:[],YEAR:[]};function D(e){return{DAY:_(e,k),WEEK:_(e,T),MONTH:_(e,Y),YEAR:_(e,R)}}function H(e){return S.apply(this,arguments)}function S(){return(S=Object(p.a)(f.a.mark((function e(t){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K(t);case 2:return n=e.sent,e.abrupt("return",n?U(n):[]);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function K(e){return B.apply(this,arguments)}function B(){return(B=Object(p.a)(f.a.mark((function e(t){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P(t);case 2:return n=e.sent,e.abrupt("return",n?JSON.parse(n):null);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function P(e){return new Promise((function(t){var n=new FileReader;n.onload=function(e){var n,r=null===(n=e.target)||void 0===n?void 0:n.result;t(r?r.toString():null)},n.readAsText(e)}))}function U(e){return e.messages.map((function(e){var t=e.sender_name,n=e.content,r=e.timestamp_ms;return{sender:Object(b.decode)(t),content:n?Object(b.decode)(n):null,time:r}}))}function _(e,t){var n=Object(E.sortBy)(e,"time"),r=function(e){return Object(E.orderBy)(Object.entries(C(e)).map((function(e){var t=Object(o.a)(e,2);return{sender:t[0],numberOfMessages:t[1]}})),"numberOfMessages","desc").map((function(e){return e.sender}))}(n);return function(e,t){var n=function(e,t){return Object(E.groupBy)(e,(function(e){var n=e.time;return I(t)(n)}))}(e,t);return function(e,t){if(0===e.length)return function(){return[]};var n=e[0].time,r=e[e.length-1].time,a=I(t)(n),u=r;return{DAY:function(){return Object(y.a)({start:a,end:u})},WEEK:function(){return Object(j.a)({start:a,end:u},{weekStartsOn:1})},MONTH:function(){return Object(w.a)({start:a,end:u})},YEAR:function(){return Object(M.a)({start:a,end:u})}}[t]}(e,t)().map((function(e){return{time:e.getTime(),messages:n[e.getTime()]||[]}}))}(n,t).map((function(e){var n=e.time,a=C(e.messages);return Object(d.a)({id:J(Number(n),t)},r.reduce((function(e,t){return Object(d.a)({},e,Object(m.a)({},t,a[t]||0))}),{}))}))}function C(e){return Object(E.mapValues)(function(e){return Object(E.groupBy)(e,(function(e){return e.sender}))}(e),(function(e){return e.length}))}function I(e){return{DAY:function(e){return Object(O.a)(e).getTime()},WEEK:function(e){return Object(g.a)(e,{weekStartsOn:1}).getTime()},MONTH:function(e){return Object(v.a)(e).getTime()},YEAR:function(e){return Object(h.a)(e).getTime()}}[e]}function J(e,t){return"".concat(Object(A.a)(new Date(e),{DAY:"dd/MM/yyyy",WEEK:"dd/MM/yyyy",MONTH:"MMM yyyy",YEAR:"yyyy"}[t])).concat({DAY:"",WEEK:" week",MONTH:"",YEAR:""}[t])}n(565);var L=n(303),F=(n(210),n(305)),G=n(597);function V(){}var q=function(e){var t=e.onComplete,n=e.style;return u.a.createElement(L.a,{beforeUpload:function(){var e=Object(p.a)(f.a.mark((function e(n,r){var a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u=r,n.uid!==u[u.length-1].uid){e.next=5;break}return e.next=3,N(r);case 3:a=e.sent,t(a);case 5:return e.abrupt("return",Promise.resolve());case 6:case"end":return e.stop()}var u}),e)})));return function(t,n){return e.apply(this,arguments)}}(),customRequest:V,accept:"application/json",multiple:!0,showUploadList:!1},u.a.createElement(F.a,{style:n},u.a.createElement(G.a,null)," Upload messages"))},X=(n(421),n(205)),$=function(e){var t=e.selected,n=e.onSelect,a=e.disabled,c=e.disabledUnits;return u.a.createElement(X.a.Group,{disabled:a},Object.values(r).map((function(e){return u.a.createElement(X.a.Button,{value:e,checked:e===t,onChange:function(e){var t=e.target.value;return n(t)},disabled:c.includes(e),key:e},e)})))},z=(n(423),n(54)),Q=function(){return u.a.createElement(z.a,{image:z.a.PRESENTED_IMAGE_SIMPLE,style:{marginTop:128}})},Z=n(289);function ee(e){return e.length>20?e.filter((function(t,n){return n%Math.floor(e.length/20)===0})).map((function(e){return e.id})):void 0}var te=function(e){var t=e.data;return u.a.createElement("div",{style:{height:640}},u.a.createElement(Z.a,{data:t,keys:t.length>0?Object.keys(t[0]).filter((function(e){return"id"!==e})):[],margin:{top:48,right:256,bottom:96,left:48},enableLabel:!1,axisBottom:{tickPadding:8,tickRotation:-45,tickValues:ee(t)},legends:[{dataFrom:"keys",anchor:"bottom-right",direction:"column",translateX:128,itemWidth:128,itemHeight:20}],animate:!1}))},ne=s.a.Title;function re(e){return Object.values(r).filter((function(t){return e[t].length>500}))}var ae=function(){var e=Object(a.useState)(W),t=Object(o.a)(e,2),n=t[0],c=t[1],i=Object(a.useState)(r.MONTH),s=Object(o.a)(i,2),l=s[0],f=s[1],m=n[l];return u.a.createElement("main",{style:{padding:32}},u.a.createElement(ne,null,"Messenger stats"),u.a.createElement(q,{onComplete:c,style:{marginRight:16}}),u.a.createElement($,{selected:l,onSelect:f,disabled:n===W,disabledUnits:re(n)}),n===W?u.a.createElement(Q,null):u.a.createElement(te,{data:m}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(u.a.createElement(ae,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[339,1,2]]]);
//# sourceMappingURL=main.45a0ab86.chunk.js.map